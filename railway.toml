# Railway Configuration for Letta
# This configures both the Letta server and PostgreSQL database

[build]
builder = "DOCKERFILE"
dockerfilePath = "Dockerfile"

[deploy]
startCommand = "./letta/server/startup.sh"
healthcheckPath = "/v1/health"
healthcheckTimeout = 300
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

# Environment variables that Railway will use
# Note: Set sensitive values in Railway dashboard, not here
[[deploy.environmentVariables]]
name = "PORT"
value = "8283"

[[deploy.environmentVariables]]
name = "HOST"
value = "0.0.0.0"

[[deploy.environmentVariables]]
name = "LETTA_ENVIRONMENT"
value = "PRODUCTION"

# PostgreSQL connection will be auto-configured by Railway if you add a PostgreSQL service
# Railway provides: DATABASE_URL, PGHOST, PGPORT, PGUSER, PGPASSWORD, PGDATABASE
# We'll map these to Letta's expected format

[[deploy.environmentVariables]]
name = "LETTA_PG_URI"
value = "${{Postgres.DATABASE_URL}}"

[[deploy.environmentVariables]]
name = "POSTGRES_USER"
value = "${{Postgres.PGUSER}}"

[[deploy.environmentVariables]]
name = "POSTGRES_PASSWORD"
value = "${{Postgres.PGPASSWORD}}"

[[deploy.environmentVariables]]
name = "POSTGRES_DB"
value = "${{Postgres.PGDATABASE}}"

# Add your API keys in Railway dashboard as environment variables:
# - OPENAI_API_KEY
# - ANTHROPIC_API_KEY
# - GROQ_API_KEY
# - GEMINI_API_KEY
# etc.
